import{r as d,j as e,F as R}from"./app-Bgxzhrvc.js";import{G as U}from"./GalleryController-DimcFaM-.js";import{D as Y,b as A,a as I,c as k,d as G,e as S,f as E,g as O}from"./dialog-DyAeqWL_.js";import{B as h}from"./button-2PUVNpYc.js";import{I as j}from"./input-B3PHjxIm.js";import{L as r}from"./label-HpvW4xIi.js";import{I as c}from"./input-error-9URGWeZJ.js";import{R as $}from"./rich-text-editor-BcwHZ5q7.js";import{Y as T}from"./youtube-THD4qb3f.js";import{I as V}from"./image-DQYlxjbm.js";import{X as q}from"./x-BCrVPaUR.js";import{L as B}from"./loader-circle-BgM9NXsF.js";import"./app-h36GOZo8.js";import"./index-DW9AIAM8.js";import"./index-Np49ePWI.js";import"./index-DdyAvwB5.js";import"./index-5AvLgYyg.js";import"./index-Daeha8jH.js";import"./index-DzWfvSAt.js";import"./createLucideIcon-BU9_NwhO.js";const M=l=>{if(!l)return null;const g=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/^([a-zA-Z0-9_-]{11})$/];for(const m of g){const a=l.match(m);if(a&&a[1])return a[1]}return null},z=l=>`https://img.youtube.com/vi/${l}/maxresdefault.jpg`;function pe({trigger:l}){const[g,m]=d.useState(!1),[a,u]=d.useState([]),[D,v]=d.useState(""),[p,y]=d.useState("image_group"),[w,x]=d.useState(""),[f,b]=d.useState(null),F=o=>{const s=Array.from(o.target.files||[]).map(t=>({file:t,preview:URL.createObjectURL(t),caption:""}));u(t=>[...t,...s])},P=o=>{x(o);const i=M(o);b(i)},_=o=>{u(i=>{const s=[...i];return URL.revokeObjectURL(s[o].preview),s.splice(o,1),s})},L=(o,i)=>{u(s=>{const t=[...s];return t[o].caption=i,t})},N=()=>{a.forEach(o=>URL.revokeObjectURL(o.preview)),u([]),v(""),y("image_group"),x(""),b(null)};return e.jsxs(Y,{open:g,onOpenChange:o=>{o||N(),m(o)},children:[e.jsx(A,{asChild:!0,children:l??e.jsx(h,{children:"New Gallery"})}),e.jsx(I,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:e.jsx(R,{...U.store.form(),encType:"multipart/form-data",onSuccess:()=>{m(!1),N()},className:"space-y-5",children:({processing:o,errors:i})=>e.jsxs(e.Fragment,{children:[e.jsxs(k,{children:[e.jsx(G,{children:"Create Gallery"}),e.jsx(S,{children:"Create a gallery of images or highlight a YouTube video."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"title",children:"Title"}),e.jsx(j,{id:"title",name:"title",required:!0,placeholder:"My Photo Gallery",autoFocus:!0}),e.jsx(c,{message:i.title})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"description",children:"Description"}),e.jsx($,{value:D,onChange:v,placeholder:"Describe your gallery...",name:"description"}),e.jsx(c,{message:i.description})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"option",children:"Option"}),e.jsxs("select",{id:"option",name:"option",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"",children:"Select an option"}),e.jsx("option",{value:"Abhidh",children:"Abhidh"}),e.jsx("option",{value:"Abhidh Creative",children:"Abhidh Creative"}),e.jsx("option",{value:"Abhidh Academy",children:"Abhidh Academy"})]}),e.jsx(c,{message:i.option})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"media_type",children:"Content Type"}),e.jsxs("select",{id:"media_type",name:"media_type",value:p,onChange:s=>{const t=s.target.value;y(t),t==="youtube"?(a.forEach(n=>URL.revokeObjectURL(n.preview)),u([])):(x(""),b(null))},className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx("option",{value:"image_group",children:"Group of Images"}),e.jsx("option",{value:"youtube",children:"YouTube Video"})]}),e.jsx(c,{message:i.media_type})]}),p==="youtube"?e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"youtube_url",children:"YouTube Video URL"}),e.jsxs("div",{className:"relative",children:[e.jsx(j,{id:"youtube_url",name:"youtube_url",type:"url",required:!0,value:w,onChange:s=>P(s.target.value),placeholder:"https://www.youtube.com/watch?v=..."}),e.jsx(T,{className:"absolute right-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Paste the full YouTube link. We will embed the video in the gallery."}),f&&e.jsxs("div",{className:"mt-3 rounded-lg border border-primary/20 bg-primary/5 p-4",children:[e.jsx(r,{className:"text-sm font-medium text-foreground mb-2 block",children:"Video Preview"}),e.jsxs("div",{className:"relative aspect-video w-full max-w-md overflow-hidden rounded-lg border",children:[e.jsx("img",{src:z(f),alt:"YouTube video thumbnail",className:"h-full w-full object-cover",onError:s=>{const t=s.target;t.src=`https://img.youtube.com/vi/${f}/hqdefault.jpg`}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"rounded-full bg-red-600/90 p-3 shadow-lg",children:e.jsx(T,{className:"h-8 w-8 text-white"})})})]})]}),e.jsx(c,{message:i.youtube_url})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(r,{htmlFor:"photos",children:"Photos"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{htmlFor:"photos",className:"inline-flex cursor-pointer items-center gap-2 rounded-md border px-3 py-2 text-sm hover:bg-muted",children:[e.jsx(V,{className:"h-4 w-4"}),"Choose photos"]}),e.jsx("input",{id:"photos",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:F})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"PNG/JPG up to 2MB each. Select multiple files."}),e.jsx(c,{message:i.photos})]}),a.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(r,{children:"Photo Previews"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:a.map((s,t)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.preview,alt:`Preview ${t+1}`,className:"w-full h-24 object-cover rounded border"}),e.jsx(h,{type:"button",size:"sm",variant:"destructive",className:"absolute -top-2 -right-2 h-6 w-6 p-0",onClick:()=>_(t),children:e.jsx(q,{className:"h-3 w-3"})}),e.jsx(j,{placeholder:"Caption (optional)",value:s.caption,onChange:n=>L(t,n.target.value),className:"mt-2 text-xs"})]},t))})]}),a.map((s,t)=>e.jsx("input",{type:"file",name:"photos[]",style:{display:"none"},ref:n=>{if(n){const C=new DataTransfer;C.items.add(s.file),n.files=C.files}}},`photo-${t}`)),a.map((s,t)=>e.jsx("input",{type:"hidden",name:`captions[${t}]`,value:s.caption},`caption-${t}`))]}),e.jsxs(E,{className:"gap-2 sm:gap-0",children:[e.jsx(O,{asChild:!0,children:e.jsx(h,{type:"button",variant:"outline",disabled:o,children:"Cancel"})}),e.jsxs(h,{type:"submit",disabled:o||p==="image_group"&&a.length===0||p==="youtube"&&w.trim()==="",children:[o&&e.jsx(B,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Gallery"]})]})]})})})]})}export{pe as default};
