import{r as _,a as M,j as e,b as W}from"./app-DeyNhaIj.js";import{C as J}from"./CourseController-IFXHYWAo.js";import{D as Q,b as U,a as X,c as Y,d as Z,e as I,f as ee,g as se}from"./dialog-VLgjrFb4.js";import{B as o}from"./button-Po8_hoCj.js";import{I as u}from"./input-DYNUQEB0.js";import{L as c}from"./label-C5nTzMn2.js";import{S as C,a as S,b as w,c as k,d as x}from"./select-DgO_v8Hj.js";import{S as te}from"./switch-CZ5_b2XX.js";import{T}from"./textarea-B8phaufl.js";import{I as m}from"./input-error-9cFJtkRf.js";import{R as ae}from"./rich-text-editor-BN0U7LEJ.js";import{T as h}from"./trash-2-D32PI3Pn.js";import{P as g}from"./plus-KzjcoXJr.js";import{L as ie}from"./loader-circle-3LwKL-vM.js";import"./app-D68BraIN.js";import"./index-DW9AIAM8.js";import"./index-CdSBMCOc.js";import"./index-VNmnc6HY.js";import"./index-BK4guFTW.js";import"./index-XU9KE0KS.js";import"./x-Cmss8qIq.js";import"./createLucideIcon-Duo5QKwh.js";import"./index-87MTScox.js";import"./index-D3zOfROK.js";import"./index-PvPWVqt0.js";import"./index-CVV1tXhf.js";import"./index-B_izgXN0.js";import"./chevron-down-DNYYSYNe.js";import"./check-CtlYdAwC.js";import"./chevron-up-BPPvmrAA.js";function qe({programs:y,trigger:D}){const[F,f]=_.useState(!1),{data:i,setData:l,post:re,processing:v,errors:d,reset:L}=M({course_type:"guided",title:"",program_id:null,featured:!1,price:null,description:"",duration:"",target_audience:"",key_learning_objectives:[""],syllabus:[{session:1,course_topic:"",learnings:[""],outcomes:[""],hours:0}],topics:[{topic:"",subtopics:[""],duration:"",content:""}]}),N=()=>{L(),f(!1)},A=()=>{const s=[...i.syllabus,{session:i.syllabus.length+1,course_topic:"",learnings:[""],outcomes:[""],hours:0}];l("syllabus",s)},O=s=>{if(i.syllabus.length===1)return;const t=i.syllabus.filter((a,r)=>r!==s);t.forEach((a,r)=>{a.session=r+1}),l("syllabus",t)},j=(s,t,a)=>{const r=[...i.syllabus];(t==="learnings"||t==="outcomes")&&Array.isArray(a),r[s][t]=a,l("syllabus",r)},z=s=>{const t=[...i.syllabus];t[s].learnings.push(""),l("syllabus",t)},$=(s,t)=>{const a=[...i.syllabus];a[s].learnings=a[s].learnings.filter((r,n)=>n!==t),l("syllabus",a)},q=s=>{const t=[...i.syllabus];t[s].outcomes.push(""),l("syllabus",t)},P=(s,t)=>{const a=[...i.syllabus];a[s].outcomes=a[s].outcomes.filter((r,n)=>n!==t),l("syllabus",a)},E=()=>{l("key_learning_objectives",[...i.key_learning_objectives,""])},H=s=>{i.key_learning_objectives.length!==1&&l("key_learning_objectives",i.key_learning_objectives.filter((t,a)=>a!==s))},R=()=>{const s=[...i.topics,{topic:"",subtopics:[""],duration:"",content:""}];l("topics",s)},B=s=>{i.topics.length!==1&&l("topics",i.topics.filter((t,a)=>a!==s))},b=_.useCallback((s,t,a)=>{l(r=>{const n=[...r.topics];return t==="subtopics"&&Array.isArray(a)?n[s]={...n[s],subtopics:a}:n[s]={...n[s],[t]:a},{...r,topics:n}})},[l]),K=s=>{const t=[...i.topics];t[s].subtopics.push(""),l("topics",t)},V=(s,t)=>{const a=[...i.topics];a[s].subtopics=a[s].subtopics.filter((r,n)=>n!==t),l("topics",a)},G=s=>{s.preventDefault();const t={course_type:i.course_type,title:i.title,featured:!!i.featured};i.program_id&&(t.program_id=i.program_id),i.course_type==="guided"?(t.description=i.description,t.duration=i.duration||null,t.target_audience=i.target_audience,t.key_learning_objectives=i.key_learning_objectives.filter(a=>a.trim()!==""),t.syllabus=i.syllabus.map(a=>({session:a.session,course_topic:a.course_topic,learnings:a.learnings.filter(r=>r.trim()!==""),outcomes:a.outcomes.filter(r=>r.trim()!==""),hours:a.hours}))):t.topics=i.topics.map(a=>({topic:a.topic,subtopics:a.subtopics.filter(r=>r.trim()!==""),duration:a.duration||null,content:a.content})),W.post(J.store.url(),t,{onSuccess:()=>{N()}})};return e.jsxs(Q,{open:F,onOpenChange:s=>{s||N(),f(s)},children:[e.jsx(U,{asChild:!0,children:D??e.jsx(o,{children:"New Course"})}),e.jsx(X,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:G,className:"space-y-5",children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Create Course"}),e.jsx(I,{children:"Add a new course. Choose between Guided or Self-Paced course."})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"course_type",children:"Course Type"}),e.jsxs(C,{value:i.course_type,onValueChange:s=>l("course_type",s),required:!0,children:[e.jsx(S,{children:e.jsx(w,{placeholder:"Select course type"})}),e.jsxs(k,{children:[e.jsx(x,{value:"guided",children:"Guided Course (School/College/Corporate)"}),e.jsx(x,{value:"self_paced",children:"Self-Paced Course"})]})]}),e.jsx(m,{message:d.course_type})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"title",children:"Course Title"}),e.jsx(u,{id:"title",name:"title",required:!0,value:i.title,onChange:s=>l("title",s.target.value),placeholder:"Course Title",autoFocus:!0}),e.jsx(m,{message:d.title})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"program_id",children:"Program (Optional)"}),e.jsxs(C,{value:i.program_id?String(i.program_id):"none",onValueChange:s=>l("program_id",s==="none"?null:Number(s)),children:[e.jsx(S,{children:e.jsx(w,{placeholder:"Select program (optional)"})}),e.jsx(k,{children:y.length>0?e.jsxs(e.Fragment,{children:[e.jsx(x,{value:"none",children:"None"}),y.map(s=>e.jsx(x,{value:String(s.id),children:s.name},s.id))]}):e.jsx(x,{value:"none",disabled:!0,children:"No programs available"})})]}),e.jsx(m,{message:d.program_id})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{id:"featured",checked:i.featured,onCheckedChange:s=>l("featured",s)}),e.jsx(c,{htmlFor:"featured",children:"Featured Course"})]}),i.course_type==="guided"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"description",children:"Course Description"}),e.jsx(T,{id:"description",name:"description",required:!0,placeholder:"Describe the course...",rows:5,value:i.description,onChange:s=>l("description",s.target.value)}),e.jsx(m,{message:d.description})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"duration",children:"Duration"}),e.jsx(u,{id:"duration",name:"duration",placeholder:"e.g., 19 Hours, 2 weeks",value:i.duration,onChange:s=>l("duration",s.target.value)}),e.jsx(m,{message:d.duration})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"target_audience",children:"Target Audience"}),e.jsx(T,{id:"target_audience",name:"target_audience",required:!0,placeholder:"HR Professionals, Managers, Team Leaders",rows:3,value:i.target_audience,onChange:s=>l("target_audience",s.target.value)}),e.jsx(m,{message:d.target_audience})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Key Learning Objectives"}),i.key_learning_objectives.map((s,t)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{value:s,onChange:a=>{const r=[...i.key_learning_objectives];r[t]=a.target.value,l("key_learning_objectives",r)},placeholder:"Learning objective"}),i.key_learning_objectives.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>H(t),children:e.jsx(h,{className:"h-4 w-4"})})]},t)),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:E,className:"w-fit",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Add Learning Objective"]}),e.jsx(m,{message:d.key_learning_objectives})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Syllabus"}),e.jsx("div",{className:"rounded-md border",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium",children:"Session"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium",children:"Course Topic"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium",children:"Learnings"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium",children:"Outcomes"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium",children:"Hours"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-medium",children:"Actions"})]})}),e.jsx("tbody",{children:i.syllabus.map((s,t)=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx(u,{type:"number",name:`syllabus[${t}][session]`,value:s.session,onChange:a=>j(t,"session",Number(a.target.value)),className:"w-20",required:!0})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(u,{name:`syllabus[${t}][course_topic]`,value:s.course_topic,onChange:a=>j(t,"course_topic",a.target.value),placeholder:"Course Topic",required:!0})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"space-y-1 min-w-[300px]",children:[s.learnings.map((a,r)=>e.jsxs("div",{className:"flex gap-1",children:[e.jsx(u,{name:`syllabus[${t}][learnings][${r}]`,value:a,onChange:n=>{const p=[...s.learnings];p[r]=n.target.value,j(t,"learnings",p)},placeholder:"Learning point",required:!0}),s.learnings.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>$(t,r),children:e.jsx(h,{className:"h-3 w-3"})})]},r)),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>z(t),className:"w-full text-xs",children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"Add Learning"]})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"space-y-1 min-w-[300px]",children:[s.outcomes.map((a,r)=>e.jsxs("div",{className:"flex gap-1",children:[e.jsx(u,{name:`syllabus[${t}][outcomes][${r}]`,value:a,onChange:n=>{const p=[...s.outcomes];p[r]=n.target.value,j(t,"outcomes",p)},placeholder:"Outcome"}),s.outcomes.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>P(t,r),children:e.jsx(h,{className:"h-3 w-3"})})]},r)),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>q(t),className:"w-full text-xs",children:[e.jsx(g,{className:"h-3 w-3 mr-1"}),"Add Outcome"]})]})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(u,{type:"number",step:"0.5",name:`syllabus[${t}][hours]`,value:s.hours||"",onChange:a=>j(t,"hours",Number(a.target.value)),className:"w-20",required:!0})}),e.jsx("td",{className:"px-3 py-2",children:e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>O(t),disabled:i.syllabus.length===1,children:e.jsx(h,{className:"h-4 w-4"})})})]},t))})]})})}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:A,className:"w-fit",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Add Session"]}),e.jsx(m,{message:d.syllabus})]})]}),i.course_type==="self_paced"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"price",children:"Price (Rs.)"}),e.jsx(u,{id:"price",name:"price",type:"number",min:"0",step:"1",placeholder:"e.g., 5000",value:i.price??"",onChange:s=>l("price",s.target.value?Number(s.target.value):null)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter price in Nepali Rupees (no decimals)"}),e.jsx(m,{message:d.price})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Topics"}),e.jsx("div",{className:"space-y-4",children:i.topics.map((s,t)=>e.jsxs("div",{className:"rounded-md border p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium",children:["Topic ",t+1]}),e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>B(t),disabled:i.topics.length===1,children:e.jsx(h,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Topic Name"}),e.jsx(u,{name:`topics[${t}][topic]`,value:s.topic,onChange:a=>b(t,"topic",a.target.value),placeholder:"e.g., Introduction to Digital Marketing",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Duration"}),e.jsx(u,{name:`topics[${t}][duration]`,value:s.duration,onChange:a=>b(t,"duration",a.target.value),placeholder:"e.g., 1.5 hrs, 2 hrs"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Subtopics"}),e.jsxs("div",{className:"space-y-2",children:[s.subtopics.map((a,r)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{name:`topics[${t}][subtopics][${r}]`,value:a,onChange:n=>{const p=[...s.subtopics];p[r]=n.target.value,b(t,"subtopics",p)},placeholder:"Subtopic"}),s.subtopics.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>V(t,r),children:e.jsx(h,{className:"h-3 w-3"})})]},r)),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>K(t),className:"w-fit",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Add Subtopic"]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Content"}),e.jsx(ae,{value:s.content,onChange:a=>b(t,"content",a),placeholder:"Write the full content for this topic...",name:`topics[${t}][content]`})]})]},t))}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:R,className:"w-fit",children:[e.jsx(g,{className:"h-4 w-4 mr-2"}),"Add Topic"]}),e.jsx(m,{message:d.topics})]})]}),e.jsxs(ee,{className:"gap-2 sm:gap-0",children:[e.jsx(se,{asChild:!0,children:e.jsx(o,{type:"button",variant:"outline",disabled:v,children:"Cancel"})}),e.jsxs(o,{type:"submit",disabled:v,children:[v&&e.jsx(ie,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Course"]})]})]})})]})}export{qe as default};
