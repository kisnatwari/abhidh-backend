import{u as de,r as p,j as e,H as me,b as A,F as ue}from"./app-DeyNhaIj.js";import{A as pe}from"./app-layout-DKFYOApa.js";import{C as x}from"./CourseController-IFXHYWAo.js";import{B as o}from"./button-Po8_hoCj.js";import{I as d}from"./input-DYNUQEB0.js";import{L as n}from"./label-C5nTzMn2.js";import{S as P,a as V,b as H,c as K,d as _}from"./select-DgO_v8Hj.js";import{S as he}from"./switch-CZ5_b2XX.js";import{T as O}from"./textarea-B8phaufl.js";import{I as u}from"./input-error-9cFJtkRf.js";import{R as ge}from"./rich-text-editor-BN0U7LEJ.js";import{A as je}from"./arrow-left-fHVW9hbO.js";import{T as N}from"./trash-2-D32PI3Pn.js";import{P as f}from"./plus-KzjcoXJr.js";import{C as R}from"./chevron-up-BPPvmrAA.js";import{C as M}from"./chevron-down-DNYYSYNe.js";import{L as xe}from"./loader-circle-3LwKL-vM.js";import"./app-D68BraIN.js";import"./index-BK4guFTW.js";import"./index-87MTScox.js";import"./index-CdSBMCOc.js";import"./index-VNmnc6HY.js";import"./index-XU9KE0KS.js";import"./x-Cmss8qIq.js";import"./createLucideIcon-Duo5QKwh.js";import"./index-D3zOfROK.js";import"./index-PvPWVqt0.js";import"./index-B_izgXN0.js";import"./dropdown-menu-DnvfRfwY.js";import"./log-out-w465uie1.js";import"./index-DTMMEruM.js";import"./index-DW9AIAM8.js";import"./app-logo-icon-DzV0efKj.js";import"./BlogController-BN_QdlpY.js";import"./TrainerController-kQzDYQyR.js";import"./GalleryController-DimcFaM-.js";import"./ProgramController-CdHtV-DA.js";import"./ServiceController-DioFTMLC.js";import"./EnrollmentController-nChSkhQE.js";import"./TeamController-DcRrgKb3.js";import"./users-CU0YDxj1.js";import"./images-DjtTIiaX.js";import"./graduation-cap-D_pR4mHR.js";import"./book-open-check-DVbQLFY6.js";import"./user-check-BVR11qX3.js";import"./circle-user-round-DQiPr9D3.js";import"./chevron-right-CJZ6vRnf.js";import"./index-CVV1tXhf.js";import"./check-CtlYdAwC.js";function ps(){const{props:B}=de(),{course:r,programs:$}=B,[L,U]=p.useState(r.course_type||"guided"),[T,W]=p.useState(r.program_id?String(r.program_id):void 0),[G,J]=p.useState(r.price?Math.round(r.price):null),[q,D]=p.useState(r.description||""),[v,E]=p.useState(r.key_learning_objectives&&r.key_learning_objectives.length>0?r.key_learning_objectives:[""]),[m,j]=p.useState(r.syllabus&&r.syllabus.length>0?r.syllabus.map(a=>({session:a.session||1,course_topic:a.course_topic||"",learnings:a.learnings&&a.learnings.length>0?a.learnings:[""],outcomes:a.outcomes&&a.outcomes.length>0?a.outcomes:[""],hours:a.hours||0})):[{session:1,course_topic:"",learnings:[""],outcomes:[""],hours:0}]),[b,F]=p.useState(new Set([0])),[h,y]=p.useState(r.topics&&r.topics.length>0?r.topics.map(a=>({topic:a.topic||"",subtopics:a.subtopics&&a.subtopics.length>0?a.subtopics:[""],duration:a.duration||"",content:a.content||""})):[{topic:"",subtopics:[""],duration:"",content:""}]),[C,z]=p.useState(new Set([0])),Q=[{title:"Courses",href:x.index().url},{title:r.title,href:x.show.url(r.id)},{title:"Edit",href:x.edit.url(r.id)}],X=()=>{const a=[...m,{session:m.length+1,course_topic:"",learnings:[""],outcomes:[""],hours:0}];j(a),F(new Set([...b,a.length-1]))},Y=a=>{if(m.length===1)return;const i=m.filter((t,l)=>l!==a);i.forEach((t,l)=>{t.session=l+1}),j(i);const s=new Set;b.forEach(t=>{t<a?s.add(t):t>a&&s.add(t-1)}),F(s)},Z=a=>{const i=new Set(b);i.has(a)?i.delete(a):i.add(a),F(i)},w=(a,i,s)=>{const t=[...m];(i==="learnings"||i==="outcomes")&&Array.isArray(s),t[a][i]=s,j(t)},I=a=>{const i=[...m];i[a].learnings.push(""),j(i)},ee=(a,i)=>{const s=[...m];s[a].learnings=s[a].learnings.filter((t,l)=>l!==i),j(s)},se=a=>{const i=[...m];i[a].outcomes.push(""),j(i)},ae=(a,i)=>{const s=[...m];s[a].outcomes=s[a].outcomes.filter((t,l)=>l!==i),j(s)},te=()=>{E([...v,""])},ie=a=>{v.length!==1&&E(v.filter((i,s)=>s!==a))},re=()=>{const a=[...h,{topic:"",subtopics:[""],duration:"",content:""}];y(a),z(new Set([...C,a.length-1]))},le=a=>{if(h.length===1)return;y(h.filter((s,t)=>t!==a));const i=new Set;C.forEach(s=>{s<a?i.add(s):s>a&&i.add(s-1)}),z(i)},ne=a=>{const i=new Set(C);i.has(a)?i.delete(a):i.add(a),z(i)},k=(a,i,s)=>{const t=[...h];i==="subtopics"&&Array.isArray(s)?t[a].subtopics=s:t[a][i]=s,y(t)},ce=a=>{const i=[...h];i[a].subtopics.push(""),y(i)},oe=(a,i)=>{const s=[...h];s[a].subtopics=s[a].subtopics.filter((t,l)=>l!==i),y(s)};return e.jsxs(pe,{breadcrumbs:Q,children:[e.jsx(me,{title:`Edit Course: ${r.title}`}),e.jsxs("div",{className:"flex flex-col gap-6 p-6 max-w-6xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{variant:"outline",size:"icon",onClick:()=>A.visit(x.show.url(r.id)),children:e.jsx(je,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Edit Course"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.title})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card",children:e.jsx(ue,{method:"post",action:x.update.url(r.id),onSuccess:()=>{A.visit(x.show.url(r.id))},className:"p-6 space-y-6",children:({processing:a,errors:i})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"course_type",children:"Course Type *"}),e.jsxs(P,{name:"course_type",value:L,onValueChange:s=>U(s),required:!0,children:[e.jsx(V,{className:"w-full max-w-md",children:e.jsx(H,{placeholder:"Select course type"})}),e.jsxs(K,{children:[e.jsx(_,{value:"guided",children:"Guided Course (School/College/Corporate)"}),e.jsx(_,{value:"self_paced",children:"Self-Paced Course"})]})]}),e.jsx(u,{message:i.course_type})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"title",children:"Course Title *"}),e.jsx(d,{id:"title",name:"title",required:!0,defaultValue:r.title,placeholder:"Course Title",className:"max-w-2xl",autoFocus:!0}),e.jsx(u,{message:i.title})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-2xl",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"program_id",children:"Program (Optional)"}),e.jsxs(P,{value:T,onValueChange:s=>W(s==="none"?void 0:s),defaultValue:r.program_id?String(r.program_id):void 0,children:[e.jsx(V,{children:e.jsx(H,{placeholder:"Select program (optional)"})}),e.jsx(K,{children:$.length>0?e.jsxs(e.Fragment,{children:[e.jsx(_,{value:"none",children:"None"}),$.map(s=>e.jsx(_,{value:String(s.id),children:s.name},s.id))]}):e.jsx(_,{value:"none",disabled:!0,children:"No programs available"})})]}),T&&T!=="none"&&e.jsx("input",{type:"hidden",name:"program_id",value:T}),e.jsx(u,{message:i.program_id})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-8",children:[e.jsx(he,{name:"featured",id:"featured",defaultChecked:r.featured}),e.jsx(n,{htmlFor:"featured",children:"Featured Course"})]})]}),L==="guided"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"description",children:"Course Description *"}),e.jsx(O,{id:"description",name:"description",required:!0,placeholder:"Describe the course...",rows:5,value:q,onChange:s=>D(s.target.value),className:"max-w-3xl"}),e.jsx(u,{message:i.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-3xl",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"duration",children:"Duration"}),e.jsx(d,{id:"duration",name:"duration",defaultValue:r.duration||"",placeholder:"e.g., 19 Hours, 2 weeks"}),e.jsx(u,{message:i.duration})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"target_audience",children:"Target Audience *"}),e.jsx(O,{id:"target_audience",name:"target_audience",required:!0,defaultValue:r.target_audience||"",placeholder:"HR Professionals, Managers, Team Leaders",rows:3}),e.jsx(u,{message:i.target_audience})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Key Learning Objectives"}),e.jsx("div",{className:"space-y-2",children:v.map((s,t)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{name:`key_learning_objectives[${t}]`,value:s,onChange:l=>{const c=[...v];c[t]=l.target.value,E(c)},placeholder:"Learning objective",className:"max-w-2xl"}),v.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>ie(t),children:e.jsx(N,{className:"h-4 w-4"})})]},t))}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:te,className:"w-fit",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Add Learning Objective"]}),e.jsx(u,{message:i.key_learning_objectives})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-lg font-semibold",children:"Syllabus"}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:X,children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Add Session"]})]}),e.jsx("div",{className:"space-y-4",children:m.map((s,t)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-20",children:[e.jsx(n,{className:"text-xs text-muted-foreground",children:"Session"}),e.jsx(d,{type:"number",name:`syllabus[${t}][session]`,value:s.session,onChange:l=>w(t,"session",Number(l.target.value)),className:"w-20",required:!0})]}),e.jsxs(o,{type:"button",variant:"ghost",size:"sm",onClick:()=>Z(t),className:"flex items-center gap-2",children:[b.has(t)?e.jsx(R,{className:"h-4 w-4"}):e.jsx(M,{className:"h-4 w-4"}),"Session ",s.session]})]}),e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>Y(t),disabled:m.length===1,children:e.jsx(N,{className:"h-4 w-4"})})]}),b.has(t)&&e.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-muted",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Course Topic *"}),e.jsx(d,{name:`syllabus[${t}][course_topic]`,value:s.course_topic,onChange:l=>w(t,"course_topic",l.target.value),placeholder:"Introduction to Happiness at Workplace",required:!0,className:"w-full"})]}),e.jsxs("div",{className:"grid gap-2 max-w-xs",children:[e.jsx(n,{children:"Hours *"}),e.jsx(d,{type:"number",step:"0.5",name:`syllabus[${t}][hours]`,value:s.hours||"",onChange:l=>w(t,"hours",Number(l.target.value)),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Learnings *"}),e.jsx("div",{className:"space-y-2",children:s.learnings.map((l,c)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{name:`syllabus[${t}][learnings][${c}]`,value:l,onChange:S=>{const g=[...s.learnings];g[c]=S.target.value,w(t,"learnings",g)},placeholder:"Learning point",required:!0,className:"flex-1"}),s.learnings.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>ee(t,c),children:e.jsx(N,{className:"h-4 w-4"})})]},c))}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>I(t),className:"w-fit",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Add Learning"]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Outcomes"}),e.jsx("div",{className:"space-y-2",children:s.outcomes.map((l,c)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{name:`syllabus[${t}][outcomes][${c}]`,value:l,onChange:S=>{const g=[...s.outcomes];g[c]=S.target.value,w(t,"outcomes",g)},placeholder:"Outcome",className:"flex-1"}),s.outcomes.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>ae(t,c),children:e.jsx(N,{className:"h-4 w-4"})})]},c))}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>se(t),className:"w-fit",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Add Outcome"]})]})]})]},t))}),e.jsx(u,{message:i.syllabus})]})]}),L==="self_paced"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"price",children:"Price (Rs.)"}),e.jsx(d,{id:"price",name:"price",type:"number",min:"0",step:"1",placeholder:"e.g., 5000",value:G??"",onChange:s=>J(s.target.value?Number(s.target.value):null),className:"max-w-md"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter price in Nepali Rupees (no decimals)"}),e.jsx(u,{message:i.price})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"description",children:"Course Description"}),e.jsx(O,{id:"description",name:"description",placeholder:"Describe the course...",rows:5,value:q,onChange:s=>D(s.target.value),className:"max-w-3xl"}),e.jsx(u,{message:i.description})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-lg font-semibold",children:"Topics"}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:re,children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Add Topic"]})]}),e.jsx("div",{className:"space-y-4",children:h.map((s,t)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(o,{type:"button",variant:"ghost",size:"sm",onClick:()=>ne(t),className:"flex items-center gap-2",children:[C.has(t)?e.jsx(R,{className:"h-4 w-4"}):e.jsx(M,{className:"h-4 w-4"}),"Topic ",t+1]}),e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>le(t),disabled:h.length===1,children:e.jsx(N,{className:"h-4 w-4"})})]}),C.has(t)&&e.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-muted",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Topic Name *"}),e.jsx(d,{name:`topics[${t}][topic]`,value:s.topic,onChange:l=>k(t,"topic",l.target.value),placeholder:"e.g., Introduction to Digital Marketing",required:!0,className:"w-full"})]}),e.jsxs("div",{className:"grid gap-2 max-w-xs",children:[e.jsx(n,{children:"Duration"}),e.jsx(d,{name:`topics[${t}][duration]`,value:s.duration,onChange:l=>k(t,"duration",l.target.value),placeholder:"e.g., 1.5 hrs, 2 hrs"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Subtopics"}),e.jsx("div",{className:"space-y-2",children:s.subtopics.map((l,c)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{name:`topics[${t}][subtopics][${c}]`,value:l,onChange:S=>{const g=[...s.subtopics];g[c]=S.target.value,k(t,"subtopics",g)},placeholder:"Subtopic",className:"flex-1"}),s.subtopics.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>oe(t,c),children:e.jsx(N,{className:"h-4 w-4"})})]},c))}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>ce(t),className:"w-fit",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Add Subtopic"]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Content *"}),e.jsx(ge,{value:s.content,onChange:l=>k(t,"content",l),placeholder:"Write the full content for this topic...",name:`topics[${t}][content]`})]})]})]},t))}),e.jsx(u,{message:i.topics})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>A.visit(x.show.url(r.id)),disabled:a,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:a,children:[a&&e.jsx(xe,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Course"]})]})]})})})]})]})}export{ps as default};
