import{u as ue,r as p,j as e,H as pe,b as z,F as he}from"./app-DnFC_eNL.js";import{A as ge}from"./app-layout-CPQWTGmO.js";import{C as x}from"./CourseController-IFXHYWAo.js";import{B as o}from"./button-rPaPehJE.js";import{I as d}from"./input-CHVdq988.js";import{L as c}from"./label-CL8gTQN-.js";import{S as V,a as H,b as R,c as K,d as _}from"./select-ssExcQiX.js";import{S as je}from"./switch-DK-5hmxD.js";import{T as A}from"./textarea--jYAAOoe.js";import{I as m}from"./input-error-BW0P0i6f.js";import{R as xe}from"./rich-text-editor-DcsXA-i6.js";import{A as ve}from"./arrow-left-CCvMUDLF.js";import{T as f}from"./trash-2-B5Bw4xnK.js";import{P as b}from"./plus-BcU-it2E.js";import{C as M}from"./chevron-up-DExuvaHM.js";import{C as B}from"./chevron-down-DTPvOuGB.js";import{L as Ne}from"./loader-circle-BcRx3z9B.js";import"./app-D68BraIN.js";import"./index-BkDfLQMe.js";import"./index-CNKFNWvJ.js";import"./index-Cry_GVru.js";import"./index-CXkLwl-k.js";import"./index-Dw2Xby9W.js";import"./x-DqWHb4Jg.js";import"./createLucideIcon-RyHhqoDJ.js";import"./index-DaROCXso.js";import"./index-B1YdNjp7.js";import"./index-D0SzBiVj.js";import"./dropdown-menu-C6nasuCZ.js";import"./log-out-CGS9sCHj.js";import"./index-DTMMEruM.js";import"./index-DW9AIAM8.js";import"./app-logo-icon-fyDU5RF6.js";import"./BlogController-BN_QdlpY.js";import"./TrainerController-kQzDYQyR.js";import"./GalleryController-DimcFaM-.js";import"./ProgramController-CdHtV-DA.js";import"./ServiceController-DioFTMLC.js";import"./EnrollmentController-nChSkhQE.js";import"./TeamController-DcRrgKb3.js";import"./users-f0rWim1W.js";import"./images-zKNtNZxa.js";import"./graduation-cap-CKuF5Oy3.js";import"./book-open-check-DnxrUPvp.js";import"./user-check-CKVwFk_t.js";import"./circle-user-round-CVoFbm53.js";import"./chevron-right-EpfWa7Hm.js";import"./index-BAQiEn5O.js";import"./check-DtLexhFW.js";function gs(){const{props:U}=ue(),{course:n,programs:O}=U,[F,W]=p.useState(n.course_type||"guided"),[T,G]=p.useState(n.program_id?String(n.program_id):void 0),[J,Q]=p.useState(n.price?Math.round(n.price):null),[P,X]=p.useState(n.featured||!1),[q,D]=p.useState(n.description||""),[v,L]=p.useState(n.key_learning_objectives&&n.key_learning_objectives.length>0?n.key_learning_objectives:[""]),[u,j]=p.useState(n.syllabus&&n.syllabus.length>0?n.syllabus.map(t=>({session:t.session||1,course_topic:t.course_topic||"",learnings:t.learnings&&t.learnings.length>0?t.learnings:[""],outcomes:t.outcomes&&t.outcomes.length>0?t.outcomes:[""],hours:t.hours||0})):[{session:1,course_topic:"",learnings:[""],outcomes:[""],hours:0}]),[N,$]=p.useState(new Set([0])),[h,y]=p.useState(n.topics&&n.topics.length>0?n.topics.map(t=>({topic:t.topic||"",subtopics:t.subtopics&&t.subtopics.length>0?t.subtopics:[""],duration:t.duration||"",content:t.content||""})):[{topic:"",subtopics:[""],duration:"",content:""}]),[C,E]=p.useState(new Set([0])),Y=[{title:"Courses",href:x.index().url},{title:n.title,href:x.show.url(n.id)},{title:"Edit",href:x.edit.url(n.id)}],Z=()=>{const t=[...u,{session:u.length+1,course_topic:"",learnings:[""],outcomes:[""],hours:0}];j(t),$(new Set([...N,t.length-1]))},I=t=>{if(u.length===1)return;const i=u.filter((a,r)=>r!==t);i.forEach((a,r)=>{a.session=r+1}),j(i);const s=new Set;N.forEach(a=>{a<t?s.add(a):a>t&&s.add(a-1)}),$(s)},ee=t=>{const i=new Set(N);i.has(t)?i.delete(t):i.add(t),$(i)},S=(t,i,s)=>{const a=[...u];(i==="learnings"||i==="outcomes")&&Array.isArray(s),a[t][i]=s,j(a)},se=t=>{const i=[...u];i[t].learnings.push(""),j(i)},ae=(t,i)=>{const s=[...u];s[t].learnings=s[t].learnings.filter((a,r)=>r!==i),j(s)},te=t=>{const i=[...u];i[t].outcomes.push(""),j(i)},ie=(t,i)=>{const s=[...u];s[t].outcomes=s[t].outcomes.filter((a,r)=>r!==i),j(s)},re=()=>{L([...v,""])},ne=t=>{v.length!==1&&L(v.filter((i,s)=>s!==t))},le=()=>{const t=[...h,{topic:"",subtopics:[""],duration:"",content:""}];y(t),E(new Set([...C,t.length-1]))},ce=t=>{if(h.length===1)return;y(h.filter((s,a)=>a!==t));const i=new Set;C.forEach(s=>{s<t?i.add(s):s>t&&i.add(s-1)}),E(i)},oe=t=>{const i=new Set(C);i.has(t)?i.delete(t):i.add(t),E(i)},k=(t,i,s)=>{const a=[...h];i==="subtopics"&&Array.isArray(s)?a[t].subtopics=s:a[t][i]=s,y(a)},de=t=>{const i=[...h];i[t].subtopics.push(""),y(i)},me=(t,i)=>{const s=[...h];s[t].subtopics=s[t].subtopics.filter((a,r)=>r!==i),y(s)};return e.jsxs(ge,{breadcrumbs:Y,children:[e.jsx(pe,{title:`Edit Course: ${n.title}`}),e.jsxs("div",{className:"flex flex-col gap-6 p-6 max-w-6xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(o,{variant:"outline",size:"icon",onClick:()=>z.visit(x.show.url(n.id)),children:e.jsx(ve,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Edit Course"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:n.title})]})]})}),e.jsx("div",{className:"rounded-lg border bg-card",children:e.jsx(he,{method:"post",action:x.update.url(n.id),onSuccess:()=>{z.visit(x.show.url(n.id))},className:"p-6 space-y-6",children:({processing:t,errors:i})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"course_type",children:"Course Type *"}),e.jsxs(V,{name:"course_type",value:F,onValueChange:s=>W(s),required:!0,children:[e.jsx(H,{className:"w-full max-w-md",children:e.jsx(R,{placeholder:"Select course type"})}),e.jsxs(K,{children:[e.jsx(_,{value:"guided",children:"Guided Course (School/College/Corporate)"}),e.jsx(_,{value:"self_paced",children:"Self-Paced Course"})]})]}),e.jsx(m,{message:i.course_type})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"title",children:"Course Title *"}),e.jsx(d,{id:"title",name:"title",required:!0,defaultValue:n.title,placeholder:"Course Title",className:"max-w-2xl",autoFocus:!0}),e.jsx(m,{message:i.title})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-2xl",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"program_id",children:"Program (Optional)"}),e.jsxs(V,{value:T,onValueChange:s=>G(s==="none"?void 0:s),defaultValue:n.program_id?String(n.program_id):void 0,children:[e.jsx(H,{children:e.jsx(R,{placeholder:"Select program (optional)"})}),e.jsx(K,{children:O.length>0?e.jsxs(e.Fragment,{children:[e.jsx(_,{value:"none",children:"None"}),O.map(s=>e.jsx(_,{value:String(s.id),children:s.name},s.id))]}):e.jsx(_,{value:"none",disabled:!0,children:"No programs available"})})]}),T&&T!=="none"&&e.jsx("input",{type:"hidden",name:"program_id",value:T}),e.jsx(m,{message:i.program_id})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-8",children:[e.jsx(je,{id:"featured",checked:P,onCheckedChange:X}),e.jsx(c,{htmlFor:"featured",children:"Featured Course"}),e.jsx("input",{type:"hidden",name:"featured",value:P?"1":"0"})]})]}),F==="guided"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"description",children:"Course Description *"}),e.jsx(A,{id:"description",name:"description",required:!0,placeholder:"Describe the course...",rows:5,value:q,onChange:s=>D(s.target.value),className:"max-w-3xl"}),e.jsx(m,{message:i.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-w-3xl",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"duration",children:"Duration"}),e.jsx(d,{id:"duration",name:"duration",defaultValue:n.duration||"",placeholder:"e.g., 19 Hours, 2 weeks"}),e.jsx(m,{message:i.duration})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"target_audience",children:"Target Audience *"}),e.jsx(A,{id:"target_audience",name:"target_audience",required:!0,defaultValue:n.target_audience||"",placeholder:"HR Professionals, Managers, Team Leaders",rows:3}),e.jsx(m,{message:i.target_audience})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"price",children:"Price (Rs.)"}),e.jsx(d,{id:"price",name:"price",type:"number",min:"0",step:"1",placeholder:"e.g., 5000",defaultValue:n.price?Math.round(n.price):"",className:"max-w-md"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter price in Nepali Rupees (no decimals)"}),e.jsx(m,{message:i.price})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Key Learning Objectives"}),e.jsx("div",{className:"space-y-2",children:v.map((s,a)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{name:`key_learning_objectives[${a}]`,value:s,onChange:r=>{const l=[...v];l[a]=r.target.value,L(l)},placeholder:"Learning objective",className:"max-w-2xl"}),v.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>ne(a),children:e.jsx(f,{className:"h-4 w-4"})})]},a))}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:re,className:"w-fit",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Add Learning Objective"]}),e.jsx(m,{message:i.key_learning_objectives})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-lg font-semibold",children:"Syllabus"}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:Z,children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Add Session"]})]}),e.jsx("div",{className:"space-y-4",children:u.map((s,a)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-20",children:[e.jsx(c,{className:"text-xs text-muted-foreground",children:"Session"}),e.jsx(d,{type:"number",name:`syllabus[${a}][session]`,value:s.session,onChange:r=>S(a,"session",Number(r.target.value)),className:"w-20",required:!0})]}),e.jsxs(o,{type:"button",variant:"ghost",size:"sm",onClick:()=>ee(a),className:"flex items-center gap-2",children:[N.has(a)?e.jsx(M,{className:"h-4 w-4"}):e.jsx(B,{className:"h-4 w-4"}),"Session ",s.session]})]}),e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>I(a),disabled:u.length===1,children:e.jsx(f,{className:"h-4 w-4"})})]}),!N.has(a)&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"hidden",name:`syllabus[${a}][course_topic]`,value:s.course_topic||""}),e.jsx("input",{type:"hidden",name:`syllabus[${a}][hours]`,value:s.hours||""}),s.learnings.map((r,l)=>e.jsx("input",{type:"hidden",name:`syllabus[${a}][learnings][${l}]`,value:r||""},l)),s.outcomes.map((r,l)=>e.jsx("input",{type:"hidden",name:`syllabus[${a}][outcomes][${l}]`,value:r||""},l))]}),N.has(a)&&e.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-muted",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Course Topic *"}),e.jsx(d,{name:`syllabus[${a}][course_topic]`,value:s.course_topic,onChange:r=>S(a,"course_topic",r.target.value),placeholder:"Introduction to Happiness at Workplace",required:!0,className:"w-full"})]}),e.jsxs("div",{className:"grid gap-2 max-w-xs",children:[e.jsx(c,{children:"Hours *"}),e.jsx(d,{type:"number",step:"0.5",name:`syllabus[${a}][hours]`,value:s.hours||"",onChange:r=>S(a,"hours",Number(r.target.value)),required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Learnings *"}),e.jsx("div",{className:"space-y-2",children:s.learnings.map((r,l)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{name:`syllabus[${a}][learnings][${l}]`,value:r,onChange:w=>{const g=[...s.learnings];g[l]=w.target.value,S(a,"learnings",g)},placeholder:"Learning point",required:!0,className:"flex-1"}),s.learnings.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>ae(a,l),children:e.jsx(f,{className:"h-4 w-4"})})]},l))}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>se(a),className:"w-fit",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Add Learning"]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Outcomes"}),e.jsx("div",{className:"space-y-2",children:s.outcomes.map((r,l)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{name:`syllabus[${a}][outcomes][${l}]`,value:r,onChange:w=>{const g=[...s.outcomes];g[l]=w.target.value,S(a,"outcomes",g)},placeholder:"Outcome",className:"flex-1"}),s.outcomes.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>ie(a,l),children:e.jsx(f,{className:"h-4 w-4"})})]},l))}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>te(a),className:"w-fit",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Add Outcome"]})]})]})]},a))}),e.jsx(m,{message:i.syllabus})]})]}),F==="self_paced"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"price",children:"Price (Rs.)"}),e.jsx(d,{id:"price",name:"price",type:"number",min:"0",step:"1",placeholder:"e.g., 5000",value:J??"",onChange:s=>Q(s.target.value?Number(s.target.value):null),className:"max-w-md"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter price in Nepali Rupees (no decimals)"}),e.jsx(m,{message:i.price})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{htmlFor:"description",children:"Course Description"}),e.jsx(A,{id:"description",name:"description",placeholder:"Describe the course...",rows:5,value:q,onChange:s=>D(s.target.value),className:"max-w-3xl"}),e.jsx(m,{message:i.description})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-lg font-semibold",children:"Topics"}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:le,children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Add Topic"]})]}),e.jsx("div",{className:"space-y-4",children:h.map((s,a)=>e.jsxs("div",{className:"rounded-lg border bg-card p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(o,{type:"button",variant:"ghost",size:"sm",onClick:()=>oe(a),className:"flex items-center gap-2",children:[C.has(a)?e.jsx(M,{className:"h-4 w-4"}):e.jsx(B,{className:"h-4 w-4"}),"Topic ",a+1]}),e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>ce(a),disabled:h.length===1,children:e.jsx(f,{className:"h-4 w-4"})})]}),C.has(a)&&e.jsxs("div",{className:"space-y-4 pl-6 border-l-2 border-muted",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Topic Name *"}),e.jsx(d,{name:`topics[${a}][topic]`,value:s.topic,onChange:r=>k(a,"topic",r.target.value),placeholder:"e.g., Introduction to Digital Marketing",required:!0,className:"w-full"})]}),e.jsxs("div",{className:"grid gap-2 max-w-xs",children:[e.jsx(c,{children:"Duration"}),e.jsx(d,{name:`topics[${a}][duration]`,value:s.duration,onChange:r=>k(a,"duration",r.target.value),placeholder:"e.g., 1.5 hrs, 2 hrs"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Subtopics"}),e.jsx("div",{className:"space-y-2",children:s.subtopics.map((r,l)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{name:`topics[${a}][subtopics][${l}]`,value:r,onChange:w=>{const g=[...s.subtopics];g[l]=w.target.value,k(a,"subtopics",g)},placeholder:"Subtopic",className:"flex-1"}),s.subtopics.length>1&&e.jsx(o,{type:"button",variant:"outline",size:"icon",onClick:()=>me(a,l),children:e.jsx(f,{className:"h-4 w-4"})})]},l))}),e.jsxs(o,{type:"button",variant:"outline",size:"sm",onClick:()=>de(a),className:"w-fit",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Add Subtopic"]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(c,{children:"Content *"}),e.jsx(xe,{value:s.content,onChange:r=>k(a,"content",r),placeholder:"Write the full content for this topic...",name:`topics[${a}][content]`})]})]})]},a))}),e.jsx(m,{message:i.topics})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4 pt-6 border-t",children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>z.visit(x.show.url(n.id)),disabled:t,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:t,children:[t&&e.jsx(Ne,{className:"mr-2 h-4 w-4 animate-spin"}),"Update Course"]})]})]})})})]})]})}export{gs as default};
