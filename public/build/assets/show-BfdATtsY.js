import{r as m,j as e,H as N,L as u}from"./app-Bgxzhrvc.js";import{A as y}from"./academy-layout-CuuJy5QJ.js";import{B as h}from"./badge-COGybBTW.js";import{B as p}from"./button-2PUVNpYc.js";import{D as C,a as k}from"./dialog-DyAeqWL_.js";import{S as _}from"./separator-FlmhJZ9J.js";import{c as L}from"./index-5AvLgYyg.js";import{C as f}from"./chevron-left-Drbz1378.js";import{C as P}from"./calendar-BrwU7UZb.js";import{I as b}from"./images-1y6J0UPH.js";import{C as g}from"./circle-play-CZAOkiLk.js";import{X as D}from"./x-BCrVPaUR.js";import{C as I}from"./chevron-right-C2g-mDCD.js";import"./app-h36GOZo8.js";import"./dropdown-menu-BquuMAtw.js";import"./index-DdyAvwB5.js";import"./index-Daeha8jH.js";import"./index-BNpA7cIy.js";import"./index-Np49ePWI.js";import"./index-BWC38D-R.js";import"./chevron-down-DzLhHXXM.js";import"./createLucideIcon-BU9_NwhO.js";import"./log-out-BTFO_Ir2.js";import"./youtube-THD4qb3f.js";import"./index-DzWfvSAt.js";const de=({gallery:t,relatedGalleries:s})=>{const[a,n]=m.useState(!1),[o,l]=m.useState(0),c=t.media_type==="youtube"&&!!t.youtube_url,x=m.useMemo(()=>R(t.created_at),[t.created_at]),d=r=>{l(r),n(!0)},j=()=>{l(r=>{const i=t.photos.length;return i===0?r:(r+1)%i})},v=()=>{l(r=>{const i=t.photos.length;return i===0?r:(r-1+i)%i})},w=t.photos[o]??null;return e.jsxs(y,{children:[e.jsx(N,{title:`${t.title} | Gallery`}),e.jsxs("div",{className:"relative overflow-hidden border-b py-16",children:[e.jsx("div",{className:"absolute inset-0 bg-linear-to-br from-background via-secondary/10 to-background"}),e.jsx("div",{className:"absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-primary/30 to-transparent"}),e.jsxs("div",{className:"container relative z-10 mx-auto px-4",children:[e.jsxs(u,{href:"/academy/galleries",className:"inline-flex items-center gap-2 text-sm text-primary hover:text-primary/80",children:[e.jsx(f,{className:"h-4 w-4"}),"Back to galleries"]}),e.jsxs("div",{className:"mt-8 flex flex-wrap items-center gap-3",children:[e.jsx(h,{variant:"secondary",children:$(t.option)}),e.jsx(h,{variant:"outline",children:c?"YouTube Video":"Image Collection"}),x?e.jsxs("span",{className:"inline-flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(P,{className:"h-4 w-4"}),"Captured ",x]}):null,c?null:e.jsxs("span",{className:"inline-flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(b,{className:"h-4 w-4"}),t.photos.length," photo",t.photos.length===1?"":"s"]})]}),e.jsx("h1",{className:"mt-6 max-w-3xl text-4xl font-bold tracking-tight text-foreground md:text-5xl",children:t.title}),t.description?e.jsx("div",{className:"prose prose-lg mt-6 max-w-3xl text-muted-foreground",dangerouslySetInnerHTML:{__html:t.description}}):null]})]}),e.jsx("section",{className:"relative py-16",children:e.jsxs("div",{className:"container mx-auto px-4",children:[c?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"overflow-hidden rounded-3xl border shadow-xl",children:e.jsx(A,{url:t.youtube_url??"",title:t.title})}),e.jsx("div",{className:"flex flex-wrap items-center gap-4",children:e.jsx(p,{asChild:!0,children:e.jsxs(u,{href:t.youtube_url??"#",target:"_blank",rel:"noopener noreferrer",children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),"Watch on YouTube"]})})})]}):t.photos.length>0?e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"overflow-hidden rounded-3xl border shadow-lg",children:e.jsxs("button",{type:"button",className:"relative block w-full focus:outline-none",onClick:()=>d(o),children:[e.jsx("img",{src:t.photos[o]?.photo_url??t.photos[0].photo_url,alt:t.photos[o]?.caption??t.title,className:"w-full max-h-[520px] object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/10 opacity-0 transition group-hover:opacity-30"})]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(p,{onClick:()=>d(o),children:"Open lightbox"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Click any thumbnail below to view it larger."})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-4",children:t.photos.map((r,i)=>e.jsxs("button",{type:"button",className:L("group relative overflow-hidden rounded-2xl border text-left transition hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-primary",o===i?"ring-2 ring-primary":""),onClick:()=>d(i),children:[e.jsx("img",{src:r.photo_url,alt:r.caption??`Gallery image ${i+1}`,className:"h-48 w-full object-cover transition duration-500 group-hover:scale-105"}),r.caption?e.jsx("div",{className:"absolute inset-x-0 bottom-0 bg-gradient-to-t from-black/70 via-black/10 to-transparent p-3 text-xs text-white",children:r.caption}):null]},r.id))})]}):e.jsx("div",{className:"rounded-3xl border bg-muted/30 p-12 text-center text-muted-foreground",children:"No images have been added to this gallery yet."}),s.length>0?e.jsxs("div",{className:"mt-16 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:"More stories"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Explore other highlights captured across Abhidh Academy."})]}),e.jsx(_,{}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 xl:grid-cols-3",children:s.map(r=>e.jsx(B,{gallery:r},r.id))})]}):null]})}),e.jsx(S,{open:a,onOpenChange:n,onNext:j,onPrev:v,photo:w,hasMultiple:t.photos.length>1})]})},S=({open:t,onOpenChange:s,onNext:a,onPrev:n,photo:o,hasMultiple:l})=>e.jsx(C,{open:t,onOpenChange:s,children:e.jsx(k,{className:"max-w-5xl border-0 bg-black/95 p-0 text-white",children:e.jsxs("div",{className:"relative flex flex-col items-center gap-4 p-6",children:[e.jsx("button",{type:"button",className:"absolute right-4 top-4 rounded-full bg-white/10 p-2 text-white transition hover:bg-white/20",onClick:()=>s(!1),children:e.jsx(D,{className:"h-4 w-4"})}),o?e.jsxs("div",{className:"relative flex w-full flex-col items-center gap-4",children:[e.jsxs("div",{className:"relative w-full overflow-hidden rounded-2xl border border-white/10",children:[e.jsx("img",{src:o.photo_url,alt:o.caption??"Gallery image",className:"mx-auto max-h-[520px] w-full object-contain"}),l?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"absolute left-4 top-1/2 -translate-y-1/2 rounded-full bg-white/10 p-3 text-white transition hover:bg-white/20",onClick:n,children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",className:"absolute right-4 top-1/2 -translate-y-1/2 rounded-full bg-white/10 p-3 text-white transition hover:bg-white/20",onClick:a,children:e.jsx(I,{className:"h-4 w-4"})})]}):null]}),o.caption?e.jsx("p",{className:"max-w-2xl text-center text-sm text-white/80",children:o.caption}):null]}):e.jsx("div",{className:"flex h-64 w-full items-center justify-center text-sm text-white/60",children:"No image selected."})]})})}),B=({gallery:t})=>{const s=t.media_type==="youtube"&&!!t.youtube_url,a=s?Y(t.youtube_url):t.photos?.[0]?.photo_url??null;return e.jsxs(u,{href:`/academy/galleries/${t.id}`,className:"group flex items-center gap-4 rounded-2xl border bg-card/70 p-4 transition hover:-translate-y-1 hover:shadow-lg",children:[e.jsxs("div",{className:"relative h-20 w-28 overflow-hidden rounded-xl border",children:[a?e.jsx("img",{src:a,alt:t.title,className:"h-full w-full object-cover transition group-hover:scale-105"}):e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-muted/40 text-muted-foreground",children:e.jsx(b,{className:"h-6 w-6"})}),s?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/40",children:e.jsx(g,{className:"h-8 w-8 text-white"})}):null]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("h3",{className:"text-base font-semibold text-foreground",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(h,{variant:"outline",className:"uppercase tracking-wide",children:s?"Video":"Photos"}),e.jsx("span",{children:"View story"})]})]})]})},$=t=>t?t.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()):"Highlights",R=t=>t?new Date(t).toLocaleDateString(void 0,{month:"short",year:"numeric"}):null,A=({url:t,title:s})=>{const a=E(t);return e.jsx("div",{className:"aspect-video w-full",children:e.jsx("iframe",{src:a,title:s,className:"h-full w-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})})},E=t=>{const s=V(t);return s?`https://www.youtube.com/embed/${s}`:t},V=t=>{try{const s=new URL(t);if(s.hostname==="youtu.be")return s.pathname.replace("/","")||null;if(s.searchParams.has("v"))return s.searchParams.get("v");if(s.pathname.startsWith("/embed/"))return s.pathname.split("/")[2]??null}catch{return null}return null},Y=t=>{if(!t)return null;try{const s=new URL(t);if(s.hostname==="youtu.be")return`https://img.youtube.com/vi/${s.pathname.replace("/","")||""}/hqdefault.jpg`;if(s.searchParams.has("v")){const a=s.searchParams.get("v");return a?`https://img.youtube.com/vi/${a}/hqdefault.jpg`:null}if(s.pathname.startsWith("/embed/")){const a=s.pathname.split("/")[2];return a?`https://img.youtube.com/vi/${a}/hqdefault.jpg`:null}}catch{return null}return null};export{de as default};
